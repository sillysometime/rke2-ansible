---
- name: Deploy RKE2 Kubernetes Cluster
  hosts: all
  become: yes
  gather_facts: yes
  serial: "{{ ansible_serial | default('100%') }}"
  
  pre_tasks:
    - name: Wait for system to be ready
      wait_for_connection:
        timeout: 300
        delay: 5

  roles:
    - rke2

  post_tasks:
    - name: Display cluster status
      debug:
        msg: "RKE2 installation completed on {{ inventory_hostname }}"